#! /usr/bin/env python
"""Show the text behind the type

This script is intended to replace the standard type command
It should look for commands in aliases, bash functions, and the bash $PATH
It assumes aliases and functions have been written to files before starting
    (because this script cannot reliably get them from sub-shells)
"""



import sys
import argparse

from whyp import whyp
from whyp import args

def parse_args():
    """Look for options from user on the command line for this script"""
    parser = argparse.ArgumentParser(description=__doc__.splitlines()[0])
    pa = parser.add_argument
    pa('commands', nargs='+', help='the commands to be typed')
    pa('-e', '--hide_errors', action='store_true',
                      help='hide error messages from successful commands')
    pa('-l', '--ls', action='store_true',
                      help='show output of "ls path" if it is a path')
    pa('-f', '--file', action='store_true',
                      help='do not show any output')
    pa('-q', '--quiet', action='store_true',
                      help='do not show any output')
    pa('-v', '--verbose', action='store_true',
                      help='whether to show more info, such as file contents')
    pa('-A', '--aliases', default='/tmp/aliases',
                      help='path to file which holds aliases')
    pa('-F', '--functions', default='/tmp/functions',
                      help='path to file which holds functions')
    arguments = parser.parse_args()

    def get_argument(name):
        return getattr(arguments, name)

    args.get = get_argument
    return arguments


def main():
    """Run the program"""
    arguments = parse_args()
    result = 0
    for command in arguments.commands:
        result |= whyp.show_command(command)
    return result


if __name__ == '__main__':
    sys.exit(main())
